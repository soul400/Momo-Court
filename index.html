<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­ÙƒÙ…Ø© Ù…ÙˆÙ…Ùˆ âš–ï¸</title>
    <!-- Ø®Ø· Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                    },
                    colors: {
                        momo: {
                            bg: '#1A202C',      // ÙƒØ­Ù„ÙŠ ØºØ§Ù…Ù‚
                            text: '#F7FAFC',    // Ø£Ø¨ÙŠØ¶ Ù…Ø§Ø¦Ù„ Ù„Ù„Ø±Ù…Ø§Ø¯ÙŠ
                            judge: '#D69E2E',   // Ø°Ù‡Ø¨ÙŠ
                            pros: '#E53E3E',    // Ø£Ø­Ù…Ø± ÙØ§ØªØ­
                            def: '#3182CE',     // Ø£Ø²Ø±Ù‚ Ø³Ù…Ø§ÙˆÙŠ
                            jury: '#805AD5',    // Ø¨Ù†ÙØ³Ø¬ÙŠ
                        }
                    },
                    animation: {
                        'gavel': 'pound 0.4s ease-in-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        pound: {
                            '0%, 100%': { transform: 'rotate(0deg)' },
                            '50%': { transform: 'rotate(-45deg)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #1A202C; color: #F7FAFC; }
        .glass-panel {
            background: rgba(45, 55, 72, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .scroll-custom::-webkit-scrollbar { width: 8px; }
        .scroll-custom::-webkit-scrollbar-track { background: #2D3748; }
        .scroll-custom::-webkit-scrollbar-thumb { background: #4A5568; border-radius: 4px; }
        .scroll-custom::-webkit-scrollbar-thumb:hover { background: #718096; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center bg-[#1A202C] overflow-x-hidden selection:bg-yellow-500 selection:text-black">

    <!-- Ù…Ø¤Ø´Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
    <div id="connection-status" class="fixed top-0 left-0 w-full text-center text-xs py-1 bg-yellow-600 text-black font-bold z-50 hidden">
        Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±...
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ´Ø®ÙŠØµ) -->
    <div id="error-toast" class="fixed bottom-4 left-4 max-w-sm bg-red-600 text-white p-4 rounded-lg shadow-2xl hidden z-50 text-sm">
        <strong class="block mb-1">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…:</strong>
        <span id="error-msg"></span>
        <button onclick="this.parentElement.style.display='none'" class="absolute top-2 left-2 text-white/50 hover:text-white">âœ•</button>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-screen" class="w-full max-w-md p-6 relative z-10 animate-fade-in">
        <div class="glass-panel p-8 rounded-2xl shadow-2xl text-center border-t-4 border-momo-judge">
            <div class="flex justify-center mb-4">
                <i data-lucide="scale" class="w-16 h-16 text-momo-judge"></i>
            </div>
            <h1 class="text-4xl font-black mb-2 text-momo-judge">Ù…Ø­ÙƒÙ…Ø© Ù…ÙˆÙ…Ùˆ</h1>
            <p class="text-gray-400 mb-8 text-sm tracking-wide">Ø§Ù„Ø¹Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© | Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</p>
            
            <div class="relative">
                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                    <i data-lucide="key" class="w-5 h-5 text-gray-500"></i>
                </div>
                <input type="password" id="access-code" 
                    class="w-full p-4 pr-10 bg-gray-800 text-white border border-gray-600 rounded-xl focus:outline-none focus:border-momo-judge focus:ring-2 focus:ring-momo-judge/50 transition-all placeholder-gray-500"
                    placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„...">
            </div>
            
            <button onclick="checkCode()" class="mt-6 w-full bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 text-gray-900 font-bold py-4 rounded-xl shadow-lg transform hover:-translate-y-1 transition-all duration-200 flex items-center justify-center gap-2">
                <span>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¹Ø©</span>
                <i data-lucide="door-open" class="w-5 h-5"></i>
            </button>
            
            <div class="mt-6 text-xs text-gray-500 space-y-1">
                <p>Ø±Ù…ÙˆØ² ØªØ¬Ø±ÙŠØ¨ÙŠØ©: ADMIN99, JUDGE1, PROS1, DEFENSE1, JURY1, GUEST</p>
            </div>
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ø£Ø¯Ù…Ù†) -->
    <div id="admin-view" class="hidden w-full max-w-6xl p-4">
        <div class="flex justify-between items-center mb-6 border-b border-gray-700 pb-4">
            <h2 class="text-3xl font-bold text-red-500 flex items-center gap-2">
                <i data-lucide="settings" class="w-8 h-8"></i>
                ØºØ±ÙØ© Ø§Ù„ØªØ­ÙƒÙ…
            </h2>
            <button onclick="location.reload()" class="bg-gray-700 px-4 py-2 rounded hover:bg-gray-600 text-sm">Ø®Ø±ÙˆØ¬</button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ© -->
            <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
                <h3 class="text-lg font-bold mb-4 text-gray-300">ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                <div class="space-y-4">
                    <input id="inp-case-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø¶ÙŠØ©" class="w-full p-3 bg-gray-900 rounded border border-gray-700 focus:border-red-500 outline-none">
                    <textarea id="inp-case-desc" placeholder="Ø­ÙŠØ«ÙŠØ§Øª Ø§Ù„Ù‚Ø¶ÙŠØ© (Ø§Ù„Ù‚ØµØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©)" class="w-full p-3 bg-gray-900 rounded h-32 border border-gray-700 focus:border-red-500 outline-none resize-none"></textarea>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <input id="inp-victim" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù†ÙŠ Ø¹Ù„ÙŠÙ‡" class="p-3 bg-gray-900 rounded border border-gray-700 focus:border-red-500 outline-none">
                        <input id="inp-accused" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªÙ‡Ù…" class="p-3 bg-gray-900 rounded border border-gray-700 focus:border-red-500 outline-none">
                    </div>
                </div>
            </div>

            <!-- Ø£Ø·Ø±Ø§Ù Ø§Ù„Ù‚Ø¶ÙŠØ© -->
            <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
                <h3 class="text-lg font-bold mb-4 text-gray-300">ğŸ‘¥ Ø£Ø·Ø±Ø§Ù Ø§Ù„Ù†Ø²Ø§Ø¹</h3>
                <div class="space-y-4">
                    <div class="flex items-center gap-2">
                        <span class="w-8 h-8 rounded bg-momo-judge flex items-center justify-center text-black font-bold">Q</span>
                        <input id="inp-judge" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¶ÙŠ" class="flex-1 p-3 bg-gray-900 rounded border border-gray-700 focus:border-momo-judge outline-none">
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-8 h-8 rounded bg-momo-pros flex items-center justify-center text-white font-bold">P</span>
                        <input id="inp-pros-lawyer" placeholder="Ù…Ø­Ø§Ù…ÙŠ Ø§Ù„Ø§Ø¯Ø¹Ø§Ø¡" class="flex-1 p-3 bg-gray-900 rounded border border-gray-700 focus:border-momo-pros outline-none">
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-8 h-8 rounded bg-momo-def flex items-center justify-center text-white font-bold">D</span>
                        <input id="inp-def-lawyer" placeholder="Ù…Ø­Ø§Ù…ÙŠ Ø§Ù„Ù…ØªÙ‡Ù…" class="flex-1 p-3 bg-gray-900 rounded border border-gray-700 focus:border-momo-def outline-none">
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-8 h-8 rounded bg-momo-jury flex items-center justify-center text-white font-bold">J</span>
                        <textarea id="inp-jurors" placeholder="Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ† (ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø± Ø£Ùˆ Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)" class="flex-1 p-3 bg-gray-900 rounded border border-gray-700 focus:border-momo-jury outline-none h-20 resize-none"></textarea>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ù‡ÙˆØ¯ -->
            <div class="lg:col-span-2 bg-gray-800 p-6 rounded-xl border border-gray-700">
                <h3 class="text-lg font-bold mb-4 text-gray-300 flex items-center gap-2">
                    <i data-lucide="eye" class="text-cyan-400"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ù‡ÙˆØ¯ ÙˆØ§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª
                </h3>
                <div id="witness-admin-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
                </div>
            </div>

            <!-- Ø§Ù„Ø£Ø¯Ù„Ø© -->
            <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-red-900/10 p-4 rounded-xl border border-red-900/50">
                    <h3 class="text-red-400 font-bold mb-2">ğŸ”¥ Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥Ø¯Ø§Ù†Ø©</h3>
                    <textarea id="inp-ev-guilt" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø£Ø¯Ù„Ø© Ù‡Ù†Ø§..." class="w-full p-3 bg-gray-900 rounded h-32 border border-red-900/50 focus:border-red-500 outline-none resize-none"></textarea>
                </div>
                <div class="bg-blue-900/10 p-4 rounded-xl border border-blue-900/50">
                    <h3 class="text-blue-400 font-bold mb-2">ğŸ›¡ï¸ Ø£Ø¯Ù„Ø© Ø§Ù„Ø¨Ø±Ø§Ø¡Ø©</h3>
                    <textarea id="inp-ev-innocence" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø£Ø¯Ù„Ø© Ù‡Ù†Ø§..." class="w-full p-3 bg-gray-900 rounded h-32 border border-blue-900/50 focus:border-blue-500 outline-none resize-none"></textarea>
                </div>
            </div>
        </div>

        <div class="mt-8 flex gap-4">
            <button id="save-btn" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold shadow-lg transition flex items-center justify-center gap-2">
                <i data-lucide="save"></i> Ø­ÙØ¸ ÙˆÙ†Ø´Ø± Ø§Ù„Ù‚Ø¶ÙŠØ©
            </button>
            <button id="reset-votes-btn" class="bg-gray-700 hover:bg-red-700 text-white px-8 rounded-xl font-bold transition">
                ØªØµÙÙŠØ± Ø§Ù„ØªØµÙˆÙŠØª
            </button>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­ÙƒÙ…Ø© (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†) -->
    <div id="court-view" class="hidden w-full max-w-7xl p-4 md:p-6 mb-20">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
            <div>
                <div class="flex items-center gap-3 mb-1">
                    <span id="role-badge" class="px-3 py-1 rounded-full text-xs font-bold bg-gray-700 border border-gray-600">Ø²Ø§Ø¦Ø±</span>
                    <span class="flex h-3 w-3 relative">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
                    </span>
                    <span class="text-xs text-red-400 font-bold">Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</span>
                </div>
                <h1 id="display-case-title" class="text-2xl md:text-4xl font-black text-momo-judge leading-tight">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©...</h1>
            </div>
            <button onclick="location.reload()" class="text-gray-500 hover:text-white transition">
                <i data-lucide="log-out"></i>
            </button>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ: Ø§Ù„Ø£Ø´Ø®Ø§Øµ -->
            <div class="lg:col-span-3 space-y-4 order-2 lg:order-1">
                <!-- Ø§Ù„Ù‚Ø§Ø¶ÙŠ -->
                <div class="glass-panel p-4 rounded-xl border-r-4 border-momo-judge relative overflow-hidden group">
                    <div class="absolute -right-4 -top-4 text-momo-judge opacity-10 group-hover:opacity-20 transition">
                        <i data-lucide="gavel" class="w-24 h-24"></i>
                    </div>
                    <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Ø§Ù„Ù‚Ø§Ø¶ÙŠ</h3>
                    <p id="display-judge" class="text-xl font-bold text-momo-judge truncate">...</p>
                </div>

                <!-- Ø§Ù„Ù…ØªÙ‡Ù… ÙˆØ§Ù„Ù…Ø¬Ù†ÙŠ Ø¹Ù„ÙŠÙ‡ -->
                <div class="grid grid-cols-2 gap-2">
                    <div class="bg-gray-800 p-3 rounded-lg border border-gray-700">
                        <h3 class="text-xs text-gray-500 mb-1">Ø§Ù„Ù…ØªÙ‡Ù… ğŸ›‘</h3>
                        <p id="display-accused" class="font-bold text-white truncate">...</p>
                        <div class="mt-2 text-xs text-gray-400">
                            <span class="block">Ø§Ù„Ø¯ÙØ§Ø¹:</span>
                            <span id="display-def-lawyer" class="text-momo-def">...</span>
                        </div>
                    </div>
                    <div class="bg-gray-800 p-3 rounded-lg border border-gray-700">
                        <h3 class="text-xs text-gray-500 mb-1">Ø§Ù„Ù…Ø¬Ù†ÙŠ Ø¹Ù„ÙŠÙ‡ ğŸ¤•</h3>
                        <p id="display-victim" class="font-bold text-white truncate">...</p>
                        <div class="mt-2 text-xs text-gray-400">
                            <span class="block">Ø§Ù„Ø§Ø¯Ø¹Ø§Ø¡:</span>
                            <span id="display-pros-lawyer" class="text-momo-pros">...</span>
                        </div>
                    </div>
                </div>
                
                <!-- Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ† (Ø¬Ø¯ÙŠØ¯) -->
                <div class="bg-gray-800 p-4 rounded-xl border-l-4 border-momo-jury">
                    <h3 class="text-xs font-bold text-gray-400 uppercase mb-2 flex items-center gap-2">
                        <i data-lucide="users" class="w-3 h-3"></i> Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ†
                    </h3>
                    <p id="display-jurors" class="text-sm text-gray-300 leading-relaxed whitespace-pre-line">...</p>
                </div>
            </div>

            <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„Ø´Ù‡ÙˆØ¯ -->
            <div class="lg:col-span-6 space-y-6 order-1 lg:order-2">
                <!-- Ø§Ù„Ù‚ØµØ© -->
                <div class="glass-panel p-6 rounded-2xl shadow-xl">
                    <h3 class="text-xl font-bold mb-4 text-gray-200 flex items-center gap-2">
                        <i data-lucide="file-text" class="text-momo-judge"></i>
                        Ø­ÙŠØ«ÙŠØ§Øª Ø§Ù„Ù‚Ø¶ÙŠØ©
                    </h3>
                    <div class="bg-gray-900/50 p-4 rounded-xl border border-gray-700/50">
                        <p id="display-case-desc" class="text-gray-300 leading-8 whitespace-pre-line text-lg font-light">...</p>
                    </div>
                </div>

                <!-- Ù‚Ø³Ù… Ø§Ù„Ø´Ù‡ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <div class="glass-panel p-6 rounded-2xl shadow-xl border border-cyan-900/50">
                    <h3 class="text-xl font-bold mb-4 text-cyan-400 flex items-center gap-2">
                        <i data-lucide="eye" class="text-cyan-400"></i>
                        Ø£Ù‚ÙˆØ§Ù„ Ø§Ù„Ø´Ù‡ÙˆØ¯
                    </h3>
                    <div id="display-witnesses-container" class="space-y-4">
                        <p class="text-gray-400 text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´Ù‡ÙˆØ¯ Ù…Ø³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
                    </div>
                </div>

                <!-- Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥Ø¯Ø§Ù†Ø© (ÙŠØ¸Ù‡Ø± Ù„Ù„Ø§Ø¯Ø¹Ø§Ø¡ØŒ Ø§Ù„Ù‚Ø§Ø¶ÙŠØŒ Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ†) -->
                <div id="section-evidence-guilt" class="hidden transform transition-all hover:scale-[1.01]">
                    <div class="bg-gradient-to-l from-red-900/20 to-gray-800 p-6 rounded-xl border-r-4 border-momo-pros">
                        <h3 class="text-lg font-bold mb-3 text-momo-pros flex items-center gap-2">
                            <i data-lucide="flame"></i> Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥Ø¯Ø§Ù†Ø©
                        </h3>
                        <p id="display-ev-guilt" class="text-gray-300 whitespace-pre-line leading-7">...</p>
                    </div>
                </div>

                <!-- Ø£Ø¯Ù„Ø© Ø§Ù„Ø¨Ø±Ø§Ø¡Ø© (ÙŠØ¸Ù‡Ø± Ù„Ù„Ø¯ÙØ§Ø¹ØŒ Ø§Ù„Ù‚Ø§Ø¶ÙŠØŒ Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ†) -->
                <div id="section-evidence-innocence" class="hidden transform transition-all hover:scale-[1.01]">
                    <div class="bg-gradient-to-l from-blue-900/20 to-gray-800 p-6 rounded-xl border-r-4 border-momo-def">
                        <h3 class="text-lg font-bold mb-3 text-momo-def flex items-center gap-2">
                            <i data-lucide="shield"></i> Ø£Ø¯Ù„Ø© Ø§Ù„Ø¨Ø±Ø§Ø¡Ø©
                        </h3>
                        <p id="display-ev-innocence" class="text-gray-300 whitespace-pre-line leading-7">...</p>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ: Ø§Ù„ØªØµÙˆÙŠØª -->
            <div class="lg:col-span-3 order-3">
                <div class="sticky top-6 space-y-6">
                    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ† -->
                    <div id="jury-section" class="hidden glass-panel p-6 rounded-2xl border border-momo-jury/30 shadow-[0_0_15px_rgba(128,90,213,0.1)]">
                        <h3 class="font-bold text-momo-jury mb-4 text-center flex items-center justify-center gap-2">
                            <i data-lucide="gavel"></i> Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ†
                        </h3>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="vote('innocent')" class="group relative overflow-hidden bg-green-900/40 hover:bg-green-600 border border-green-600 text-green-100 py-3 rounded-lg transition-all duration-300">
                                <span class="relative z-10 font-bold">Ø¨Ø±ÙŠØ¡</span>
                                <div class="absolute inset-0 bg-green-500 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left opacity-20"></div>
                            </button>
                            <button onclick="vote('guilty')" class="group relative overflow-hidden bg-red-900/40 hover:bg-red-600 border border-red-600 text-red-100 py-3 rounded-lg transition-all duration-300">
                                <span class="relative z-10 font-bold">Ù…Ø¯Ø§Ù†</span>
                                <div class="absolute inset-0 bg-red-500 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left opacity-20"></div>
                            </button>
                        </div>
                    </div>

                    <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø­ÙŠØ© -->
                    <div class="bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                        <p class="text-xs text-gray-500 uppercase tracking-widest mb-4">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø­ÙŠØ©</p>
                        
                        <div class="flex items-end justify-between px-2 mb-2">
                            <div class="text-center">
                                <span id="count-innocent" class="block text-3xl font-black text-green-500">0</span>
                                <span class="text-xs text-green-400">Ø¨Ø±ÙŠØ¡</span>
                            </div>
                            <div class="text-gray-600 pb-2">VS</div>
                            <div class="text-center">
                                <span id="count-guilty" class="block text-3xl font-black text-red-500">0</span>
                                <span class="text-xs text-red-400">Ù…Ø¯Ø§Ù†</span>
                            </div>
                        </div>

                        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ù†Ø³Ø¨Ø© -->
                        <div class="h-3 bg-gray-700 rounded-full overflow-hidden flex relative">
                            <div id="bar-innocent" class="bg-green-500 h-full transition-all duration-1000" style="width: 50%"></div>
                            <div id="bar-guilty" class="bg-red-500 h-full transition-all duration-1000" style="width: 50%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK Logic (ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Database Ø¨Ù€ Firestore
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (judge-31fea)
        const firebaseConfig = {
            apiKey: "AIzaSyBipomSPVclk5J9aFVmSJvGkk2P22YRkrU",
            authDomain: "judge-31fea.firebaseapp.com",
            projectId: "judge-31fea",
            storageBucket: "judge-31fea.firebasestorage.app",
            messagingSenderId: "820112341118",
            appId: "1:820112341118:web:bdc569841ed81467e6802f",
            measurementId: "G-QTW6XF41PF"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app); // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        const CASE_DOC_ID = 'live-case-001'; // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù„Ù‚Ø¶ÙŠØ©

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ---
        const connectionStatus = document.getElementById('connection-status');
        const errorToast = document.getElementById('error-toast');
        const errorMsg = document.getElementById('error-msg');

        function showError(msg) {
            errorMsg.innerText = msg;
            errorToast.style.display = 'block';
            setTimeout(() => errorToast.style.display = 'none', 5000);
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function ensureAuth() {
            connectionStatus.style.display = 'block';
            signInAnonymously(auth)
                .then(() => {
                    console.log("Firestore Auth: Connected to " + firebaseConfig.projectId);
                    connectionStatus.style.display = 'none';
                })
                .catch((error) => {
                    console.error("Auth Error:", error);
                    connectionStatus.innerText = "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: " + error.code;
                    connectionStatus.classList.add('bg-red-600');
                    showError("ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ±: " + error.message);
                });
        }
        
        ensureAuth();

        // --- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ---
        lucide.createIcons();

        // ØªÙˆÙ„ÙŠØ¯ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø´Ù‡ÙˆØ¯ ÙÙŠ Ø§Ù„Ø£Ø¯Ù…Ù†
        const witnessContainer = document.getElementById('witness-admin-container');
        for (let i = 1; i <= 10; i++) {
            const div = document.createElement('div');
            div.className = "bg-gray-900 p-3 rounded border border-gray-700";
            div.innerHTML = `
                <div class="text-xs text-cyan-500 mb-1 font-bold">Ø§Ù„Ø´Ø§Ù‡Ø¯ Ø±Ù‚Ù… ${i}</div>
                <input id="w-name-${i}" placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ù‡Ø¯" class="w-full mb-2 p-2 bg-gray-800 rounded border border-gray-600 text-sm focus:border-cyan-500 outline-none">
                <textarea id="w-scenario-${i}" placeholder="Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ / Ø§Ù„Ø£Ù‚ÙˆØ§Ù„" class="w-full p-2 bg-gray-800 rounded border border-gray-600 text-sm h-16 resize-none focus:border-cyan-500 outline-none"></textarea>
            `;
            witnessContainer.appendChild(div);
        }

        // --- Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ---

        window.checkCode = function() {
            const codeInput = document.getElementById('access-code');
            const code = codeInput.value.trim().toUpperCase();
            
            if(!code) {
                codeInput.classList.add('ring-2', 'ring-red-500');
                setTimeout(() => codeInput.classList.remove('ring-2', 'ring-red-500'), 1000);
                return;
            }

            const loginScreen = document.getElementById('login-screen');
            const adminView = document.getElementById('admin-view');
            const courtView = document.getElementById('court-view');
            
            loginScreen.style.opacity = '0';
            setTimeout(() => {
                loginScreen.style.display = 'none';
                
                if (code === 'ADMIN99') {
                    adminView.style.display = 'block';
                    adminView.classList.add('animate-fade-in');
                    loadAdminData();
                } else {
                    courtView.style.display = 'block';
                    courtView.classList.add('animate-fade-in');
                    setupRoleView(code);
                }
                lucide.createIcons();
            }, 300);
        };

        // --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¯Ù…Ù† (Firestore) ---
        
        document.getElementById('save-btn').addEventListener('click', async () => {
            if (!auth.currentUser) {
                showError("ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹...");
                ensureAuth();
                return;
            }

            const btn = document.getElementById('save-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="animate-pulse">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©...</span>';
            btn.disabled = true;
            
            // Ù…Ø¤Ù‚Øª Ø£Ù…Ø§Ù†
            const timeoutId = setTimeout(() => {
                btn.innerHTML = 'âš ï¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ØªØ£Ø®Ø±Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„';
                btn.disabled = false;
            }, 15000);

            // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‡ÙˆØ¯
            const witnessesData = [];
            for(let i=1; i<=10; i++) {
                const name = document.getElementById(`w-name-${i}`).value;
                const scenario = document.getElementById(`w-scenario-${i}`).value;
                if(name.trim() || scenario.trim()) {
                    witnessesData.push({ name, scenario });
                }
            }

            const caseData = {
                title: document.getElementById('inp-case-title').value,
                description: document.getElementById('inp-case-desc').value,
                judge: document.getElementById('inp-judge').value,
                victim: document.getElementById('inp-victim').value,
                accused: document.getElementById('inp-accused').value,
                defLawyer: document.getElementById('inp-def-lawyer').value,
                prosLawyer: document.getElementById('inp-pros-lawyer').value,
                jurors: document.getElementById('inp-jurors').value,
                witnessesData: witnessesData,
                evGuilt: document.getElementById('inp-ev-guilt').value,
                evInnocence: document.getElementById('inp-ev-innocence').value,
            };

            // Ø§Ø³ØªØ®Ø¯Ø§Ù… setDoc Ù…Ø¹ merge: true Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¦Ù‡Ø§
            const caseRef = doc(db, 'court', CASE_DOC_ID);
            
            try {
                await setDoc(caseRef, caseData, { merge: true });
                clearTimeout(timeoutId);
                btn.innerHTML = 'ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­! âœ…';
                btn.classList.remove('bg-green-600');
                btn.classList.add('bg-green-500');
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                    btn.classList.add('bg-green-600');
                    btn.classList.remove('bg-green-500');
                }, 2000);
            } catch (err) {
                clearTimeout(timeoutId);
                console.error("Firestore Save Error:", err);
                showError("ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: " + err.message);
                btn.innerHTML = 'âŒ ÙØ´Ù„';
                setTimeout(() => { btn.innerHTML = originalText; btn.disabled = false; }, 2000);
            }
        });

        document.getElementById('reset-votes-btn').addEventListener('click', async () => {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ØµÙˆØ§ØªØŸ')) {
                const caseRef = doc(db, 'court', CASE_DOC_ID);
                try {
                    await setDoc(caseRef, { votes: { innocent: 0, guilty: 0 } }, { merge: true });
                    alert("ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø£ØµÙˆØ§Øª.");
                } catch(err) {
                    showError("Ø­Ø¯Ø« Ø®Ø·Ø£: " + err.message);
                }
            }
        });

        async function loadAdminData() {
             const caseRef = doc(db, 'court', CASE_DOC_ID);
             try {
                 const docSnap = await getDoc(caseRef);
                 if (docSnap.exists()) {
                     const data = docSnap.data();
                     document.getElementById('inp-case-title').value = data.title || '';
                     document.getElementById('inp-case-desc').value = data.description || '';
                     document.getElementById('inp-judge').value = data.judge || '';
                     document.getElementById('inp-victim').value = data.victim || '';
                     document.getElementById('inp-accused').value = data.accused || '';
                     document.getElementById('inp-def-lawyer').value = data.defLawyer || '';
                     document.getElementById('inp-pros-lawyer').value = data.prosLawyer || '';
                     document.getElementById('inp-jurors').value = data.jurors || '';
                     document.getElementById('inp-ev-guilt').value = data.evGuilt || '';
                     document.getElementById('inp-ev-innocence').value = data.evInnocence || '';

                     // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡ÙˆØ¯
                     if(data.witnessesData && Array.isArray(data.witnessesData)) {
                         data.witnessesData.forEach((w, index) => {
                             if(index < 10) {
                                 document.getElementById(`w-name-${index+1}`).value = w.name || '';
                                 document.getElementById(`w-scenario-${index+1}`).value = w.scenario || '';
                             }
                         });
                     }
                 }
             } catch (err) {
                 console.error("Error loading data:", err);
                 showError("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø§Ø¨Ù‚Ø© Ø£Ùˆ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ©");
             }
        }

        // --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø± (Firestore Listener) ---

        function setupRoleView(code) {
            const roleBadge = document.getElementById('role-badge');
            const guiltSection = document.getElementById('section-evidence-guilt');
            const innocenceSection = document.getElementById('section-evidence-innocence');
            const jurySection = document.getElementById('jury-section');
            
            let roleName = "Ø¶ÙŠÙ";
            let roleClass = "bg-gray-600 text-gray-200";

            if (code === 'JUDGE1') {
                roleName = "Ø§Ù„Ù‚Ø§Ø¶ÙŠ âš–ï¸";
                roleClass = "bg-momo-judge text-black";
                guiltSection.style.display = 'block';
                innocenceSection.style.display = 'block';
            } 
            else if (code === 'DEFENSE1') {
                roleName = "Ø§Ù„Ø¯ÙØ§Ø¹ ğŸ›¡ï¸";
                roleClass = "bg-momo-def text-white";
                innocenceSection.style.display = 'block';
            }
            else if (code === 'PROS1') {
                roleName = "Ø§Ù„Ø§Ø¯Ø¹Ø§Ø¡ ğŸ”¥";
                roleClass = "bg-momo-pros text-white";
                guiltSection.style.display = 'block';
            }
            else if (code === 'JURY1') {
                roleName = "Ø§Ù„Ù…Ø­Ù„ÙÙŠÙ† ğŸ‘¥";
                roleClass = "bg-momo-jury text-white";
                jurySection.style.display = 'block';
                guiltSection.style.display = 'block';
                innocenceSection.style.display = 'block';
            }
            else if (code === 'WITNESS1') {
                roleName = "Ø´Ø§Ù‡Ø¯ ğŸ‘ï¸";
                roleClass = "bg-cyan-600 text-white";
            }

            roleBadge.textContent = roleName;
            roleBadge.className = `px-3 py-1 rounded-full text-xs font-bold border border-white/20 shadow-lg ${roleClass}`;

            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø­ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… onSnapshot
            const caseRef = doc(db, 'court', CASE_DOC_ID);
            
            onSnapshot(caseRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();

                    updateText('display-case-title', data.title);
                    updateText('display-case-desc', data.description);
                    updateText('display-judge', data.judge);
                    updateText('display-accused', data.accused);
                    updateText('display-victim', data.victim);
                    updateText('display-def-lawyer', data.defLawyer);
                    updateText('display-pros-lawyer', data.prosLawyer);
                    updateText('display-jurors', data.jurors);
                    updateText('display-ev-guilt', data.evGuilt);
                    updateText('display-ev-innocence', data.evInnocence);

                    // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡ÙˆØ¯
                    const witnessesContainer = document.getElementById('display-witnesses-container');
                    
                    if (data.witnessesData && Array.isArray(data.witnessesData) && data.witnessesData.length > 0) {
                        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù… ÙÙ‚Ø· Ø¥Ø°Ø§ ØªØºÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù‡ÙˆØ¯ Ø£Ùˆ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø´ÙƒÙ„ Ø¬Ø°Ø±ÙŠ
                        // Ù„Ù„ØªØ¨Ø³ÙŠØ· Ù†Ø¹ÙŠØ¯ Ø§Ù„Ø±Ø³Ù… Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù‡Ù†Ø§
                        witnessesContainer.innerHTML = '';
                        data.witnessesData.forEach(w => {
                            const wDiv = document.createElement('div');
                            wDiv.className = "bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-cyan-600 transition";
                            wDiv.innerHTML = `
                                <div class="flex items-center gap-2 mb-2">
                                    <div class="bg-cyan-900/50 p-2 rounded-full">
                                        <i data-lucide="user" class="w-4 h-4 text-cyan-400"></i>
                                    </div>
                                    <h4 class="font-bold text-white text-lg">${w.name || 'Ø´Ø§Ù‡Ø¯ Ù…Ø¬Ù‡ÙˆÙ„'}</h4>
                                </div>
                                <div class="bg-gray-900/50 p-3 rounded-lg border border-gray-700/30">
                                    <p class="text-gray-300 text-sm leading-relaxed whitespace-pre-line">${w.scenario || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ù‚ÙˆØ§Ù„ Ù…Ø³Ø¬Ù„Ø©.'}</p>
                                </div>
                            `;
                            witnessesContainer.appendChild(wDiv);
                        });
                        lucide.createIcons();
                    } else {
                        witnessesContainer.innerHTML = '<p class="text-gray-500 text-center py-4">Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø´Ù‡ÙˆØ¯ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø©.</p>';
                    }

                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ØµÙˆØ§Øª
                    const iVotes = data.votes?.innocent || 0;
                    const gVotes = data.votes?.guilty || 0;
                    const total = iVotes + gVotes;

                    document.getElementById('count-innocent').innerText = iVotes;
                    document.getElementById('count-guilty').innerText = gVotes;

                    if (total > 0) {
                        const iPercent = (iVotes / total) * 100;
                        const gPercent = (gVotes / total) * 100;
                        document.getElementById('bar-innocent').style.width = `${iPercent}%`;
                        document.getElementById('bar-guilty').style.width = `${gPercent}%`;
                    } else {
                        document.getElementById('bar-innocent').style.width = `50%`;
                        document.getElementById('bar-guilty').style.width = `50%`;
                    }
                }
            }, (error) => {
                console.error("Listen Error:", error);
                // Ù„Ø§ Ù†Ø¸Ù‡Ø± Ø§Ù„Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ø¨Ø´ÙƒÙ„ Ù…Ø²Ø¹Ø¬ØŒ ÙÙ‚Ø· ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
            });
        }

        function updateText(id, text) {
            const el = document.getElementById(id);
            if(el && el.innerText !== text && text !== undefined) {
                el.innerText = text || '...';
                el.classList.add('animate-pulse');
                setTimeout(() => el.classList.remove('animate-pulse'), 500);
            }
        }

        window.vote = async function(type) {
            if (!auth.currentUser) {
                showError("Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„.. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ù„Ø­Ø¸Ø§Øª");
                return;
            }
            
            const caseRef = doc(db, 'court', CASE_DOC_ID);
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… updateDoc Ù…Ø¹ increment Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© Ø§Ù„Ø¹Ø¯
                await updateDoc(caseRef, {
                    [`votes.${type}`]: increment(1)
                });
                
                // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ
                const btn = event.currentTarget;
                const originalColor = btn.style.borderColor;
                btn.style.borderColor = "#FFF";
                setTimeout(() => btn.style.borderColor = originalColor, 200);
            } catch (err) {
                console.error("Voting failed:", err);
                showError("ÙØ´Ù„ Ø§Ù„ØªØµÙˆÙŠØª: " + err.message);
            }
        };
    </script>
</body>
</html>